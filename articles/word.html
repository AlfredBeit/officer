<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>docx device • officer package</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">officer</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/powerpoint.html">Powerpoint</a>
</li>
<li>
  <a href="../articles/word.html">Word</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="https://github.com/davidgohel/officer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>docx device</h1>
            
          </div>

    
    
<div class="contents">
<blockquote>
<p><code>officer</code> provides a set of functions to manipulate Word documents from R.</p>
</blockquote>
<p><em>Package <code>magrittr</code> can be used with <code>officer</code> as it will make the workflow easier to read.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(officer)
<span class="kw">library</span>(magrittr)</code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h2>
<p>Use the function <code>read_docx</code> to create an r object representing a PowerPoint document. It takes one argument <code>path</code>: a initial Word file. If none is provided, this file will be an empty document located in the package directory. Formats and styles will be those available in the template file.</p>
<div id="create-a-word-device" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#create-a-word-device" class="anchor"> </a></body></html>Create a Word device</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_doc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_docx.html">read_docx</a></span>() 
my_doc</code></pre></div>
<pre><code>## docx document with 2 element(s)
## Available styles are:
##    style_type            style_id             style_name is_custom
## 1   paragraph              Normal                 Normal     FALSE
## 2   paragraph              Titre1              heading 1     FALSE
## 3   paragraph              Titre2              heading 2     FALSE
## 4   paragraph              Titre3              heading 3     FALSE
## 5   character      Policepardfaut Default Paragraph Font     FALSE
## 6       table       TableauNormal           Normal Table     FALSE
## 7   numbering         Aucuneliste                No List     FALSE
## 8   character              strong                 strong      TRUE
## 9   paragraph            centered               centered      TRUE
## 10      table              Grille             Table Grid     FALSE
## 11      table       tabletemplate         table_template      TRUE
## 12      table Listeclaire-Accent2    Light List Accent 2     FALSE
## 13  character           Titre1Car            Titre 1 Car      TRUE
## 14  character           Titre2Car            Titre 2 Car      TRUE
## 15  character           Titre3Car            Titre 3 Car      TRUE
##    is_default
## 1        TRUE
## 2       FALSE
## 3       FALSE
## 4       FALSE
## 5        TRUE
## 6        TRUE
## 7        TRUE
## 8       FALSE
## 9       FALSE
## 10      FALSE
## 11      FALSE
## 12      FALSE
## 13      FALSE
## 14      FALSE
## 15      FALSE</code></pre>
</div>
<div id="add-elements-to-document" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#add-elements-to-document" class="anchor"> </a></body></html>Add elements to document</h3>
<p>Let’s add an image in the documet first.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">src &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">".png"</span>)
<span class="kw">png</span>(<span class="dt">filename =</span> src, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">6</span>, <span class="dt">units =</span> <span class="st">'in'</span>, <span class="dt">res =</span> <span class="dv">300</span>)
<span class="kw">barplot</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">col =</span> <span class="dv">1</span>:<span class="dv">10</span>)
<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_doc &lt;-<span class="st"> </span>my_doc %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_img.html">body_add_img</a></span>(<span class="dt">src =</span> src, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">6</span>, <span class="dt">style =</span> <span class="st">"centered"</span>)</code></pre></div>
<p>Then some paragraphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_doc &lt;-<span class="st"> </span>my_doc %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="st">"Hello world!"</span>, <span class="dt">style =</span> <span class="st">"Normal"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="st">""</span>, <span class="dt">style =</span> <span class="st">"Normal"</span>) <span class="co"># blank paragraph</span></code></pre></div>
<p>And a table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_doc &lt;-<span class="st"> </span>my_doc %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_table.html">body_add_table</a></span>(iris, <span class="dt">style =</span> <span class="st">"table_template"</span>, <span class="dt">width =</span> <span class="dv">3</span>)</code></pre></div>
</div>
<div id="write-the-word-file" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#write-the-word-file" class="anchor"> </a></body></html>Write the Word file</h3>
<p>File can be generated using function <code>print</code> and argument <code>target</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outfile &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">".docx"</span>)
<span class="kw">print</span>(my_doc, <span class="dt">target =</span> outfile )</code></pre></div>
<pre><code>## [1] "/var/folders/51/6jygptvs3bb4njv0t6x7br900000gn/T/RtmpRrBCcq/file1d60e32ffa7.docx"</code></pre>
</div>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#getting-started" class="anchor"> </a></body></html>Getting started</h2>
<p>To produce Word documents from R, you will need to manipulate few concepts.</p>
<p><code>read_docx</code> read an initial <code>docx</code> file. It takes one argument <code>path</code>: a initial Word file (I sometimes refer to it as <em>template</em>. If none is provided, this file will be an empty document located in the package directory. Styles will be those available in the template file.</p>
<div id="add-elements" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#add-elements" class="anchor"> </a></body></html>Add elements</h3>
<p>To add paragraphs, tables, images or other elements into the document, you will have to use functions starting with <code>body_add_</code>:</p>
<ul>
<li>body_add_break</li>
<li>body_add_img</li>
<li>body_add_par</li>
<li>body_add_table</li>
<li>body_add_toc</li>
<li>body_end_section</li>
<li>body_remove</li>
</ul>
</div>
<div id="cursor" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#cursor" class="anchor"> </a></body></html>Cursor</h3>
<p>A cursor is available and can be manipulated so that content can be added regarding to its position:</p>
<ul>
<li>
<code>before</code> will insert a new element before the selected element in the document.</li>
<li>
<code>after</code> will insert a new element after the selected element in the document.</li>
<li>
<code>on</code> will replace the selected element in the document by a new element.</li>
</ul>
<p>Cursor functions are the following:</p>
<ul>
<li>cursor_backward</li>
<li>cursor_begin</li>
<li>cursor_end</li>
<li>cursor_forward</li>
<li>cursor_reach</li>
</ul>
</div>
<div id="append-text-in-existing-paragraphs" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#append-text-in-existing-paragraphs" class="anchor"> </a></body></html>Append text in existing paragraphs</h3>
<p>Text and images can be inserted at the beginning or the end of the selected paragraph (by the cursor). This can be made with functions</p>
<ul>
<li>slip_in_img</li>
<li>slip_in_seqfield</li>
<li>slip_in_text</li>
</ul>
</div>
</div>
<div id="remove-content" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#remove-content" class="anchor"> </a></body></html>Remove content</h2>
<p>The function <code>body_remove</code> let remove content from a Word document. This function used with <code>cursor_*</code> functions is a convenient tool to update an existing document.</p>
<p>For illustration purpose, we will generate a document that will be used as initial document later when showing how to use <code>body_remove</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(officer)
<span class="kw">library</span>(magrittr)

str1 &lt;-<span class="st"> "Lorem ipsum dolor sit amet, consectetur adipiscing elit. "</span> %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">rep</span>(<span class="dv">20</span>) %&gt;%<span class="st"> </span><span class="kw">paste</span>(<span class="dt">collapse =</span> <span class="st">""</span>)
str2 &lt;-<span class="st"> "Drop that text"</span> 
str3 &lt;-<span class="st"> "Aenean venenatis varius elit et fermentum vivamus vehicula. "</span> %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">rep</span>(<span class="dv">20</span>) %&gt;%<span class="st"> </span><span class="kw">paste</span>(<span class="dt">collapse =</span> <span class="st">""</span>)

my_doc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_docx.html">read_docx</a></span>()  %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="dt">value =</span> str1, <span class="dt">style =</span> <span class="st">"Normal"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="dt">value =</span> str2, <span class="dt">style =</span> <span class="st">"centered"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="dt">value =</span> str3, <span class="dt">style =</span> <span class="st">"Normal"</span>) 
<span class="kw">print</span>(my_doc, <span class="dt">target =</span> <span class="st">"init_doc.docx"</span>)</code></pre></div>
<pre><code>## [1] "/Users/davidgohel/Github/officer/docs/articles/init_doc.docx"</code></pre>
<p>File <code>init_doc.docx</code> now exists and contains a paragraph containing text <em>that text</em>. In the following example, we will position the cursor on that paragraph and then delete it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_doc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_docx.html">read_docx</a></span>(<span class="dt">path =</span> <span class="st">"init_doc.docx"</span>)  %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/cursor_begin.html">cursor_reach</a></span>(<span class="dt">keyword =</span> <span class="st">"that text"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_remove.html">body_remove</a></span>()
<span class="kw">print</span>(my_doc, <span class="dt">target =</span> <span class="st">"result_doc.docx"</span>)</code></pre></div>
<pre><code>## [1] "/Users/davidgohel/Github/officer/docs/articles/result_doc.docx"</code></pre>
<p><strong>The text search is made via <code>xpath 1.0</code> and regular expressions are not supported.</strong></p>
</div>
<div id="sections" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#sections" class="anchor"> </a></body></html>Sections</h2>
<p>Sections can be added to a document. This is possible by using function <code>body_end_section</code>.</p>
<blockquote>
<p>A section start at the end of the previous section (or the beginning of the document if no preceding section exists), it stops where the section is declared. The function is reflecting that (complicated) Word concept, by adding an ending section attached to the paragraph where cursor is.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_doc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_docx.html">read_docx</a></span>()  %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="dt">value =</span> str1, <span class="dt">style =</span> <span class="st">"Normal"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="dt">value =</span> str2, <span class="dt">style =</span> <span class="st">"centered"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/body_end_section.html">body_end_section</a></span>(<span class="dt">landscape =</span> <span class="ot">TRUE</span>, <span class="dt">colwidths =</span> <span class="kw">c</span>(.<span class="dv">6</span>, .<span class="dv">4</span>), <span class="dt">space =</span> .<span class="dv">05</span>, <span class="dt">sep =</span> <span class="ot">FALSE</span>) %&gt;%
<span class="st">  </span><span class="kw"><a href="../reference/body_add_par.html">body_add_par</a></span>(<span class="dt">value =</span> str3, <span class="dt">style =</span> <span class="st">"Normal"</span>) 
<span class="kw">print</span>(my_doc, <span class="dt">target =</span> <span class="st">"section.docx"</span>)</code></pre></div>
<pre><code>## [1] "/Users/davidgohel/Github/officer/docs/articles/section.docx"</code></pre>
<p>In the previous example, first two paragraphs will be in a 2 column section and the third will be in a default section.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#getting-started">Getting started</a></li>
      <li><a href="#remove-content">Remove content</a></li>
      <li><a href="#sections">Sections</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="author">
  <p>Developed by David Gohel.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48354045-1', 'auto');
  ga('send', 'pageview');
</script></footer>
</div>

  </body>
</html>
